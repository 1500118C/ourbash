#! /bin/bash
clear
printf "Checking user account defaults: (Password Max Days)\n"
maxDays=$(grep ^PASS_MAX_DAYS /etc/login.defs | grep -o '[0-9]*')
if [ $maxDays -le 90 ]; then
	printf "\e[32mPass\e[0m\n"
else
	printf "\e[31mFail\e[0m\n"
	printf "Please run remediation"
fi

USER=$(cat /etc/passwd | grep "/bin/bash" | cut -d : -f 1)
list=(${USER})
printf "Checking existing user accounts: (Password Max Days)\n"

for i in "${list[@]}"
do
	day=$(chage -l $i | grep "Maximum number" | cut -d : -f 2)
	if [ $day -le 90 ]; then 
		printf "\e[32m$i\e[0m\n"
	else
		printf "\e[31m$i\e[0m\n"
		printf "Please run remediation"
	fi
done
