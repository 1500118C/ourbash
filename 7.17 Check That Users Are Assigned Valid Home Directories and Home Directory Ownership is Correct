#! /bin/bash

clear

echo "7.17 Check That Users Are Assigned Valid Home Directories and Home Directory Ownership is Correct"

cat /etc/passwd | awk -F : '{print $1, $3, $6}' | while read user uid dir; do 
if [ $uid -ge 1000 -a ! -d "$dir" -a $user != "nfsnobody" ]; then 
printf "\e[31mHome directory ($dir) of user $user does not exist.\e[0m\n"
else 
printf "\e[32mPass - $user $dir\e[0m\n"
fi
done



echo "Checking if Home directory ownership is correct"
ls -ld $dir | awk '{print $3, $4}' | while read owner user1; do
if [ "$owner" != "$user1" ]; then
printf "\e[31mThe home directory ($dir) of user $user1 is owned by $owner.\e[0m\n"
else 
printf "\e[32mPass\e[0m\n"
fi
done
