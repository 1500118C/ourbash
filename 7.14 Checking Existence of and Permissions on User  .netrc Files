#! /bin/bash

printf "\033[0;30m Checkiing Permissions on User .netrc Files \n" 

for dir in `/bin/cat /etc/passwd | /bin/egrep -v '(root|sync|halt|shutdown)' |/bin/awk -F: '($7 != "/sbin/nologin") { print $6 }'`; do

for file in $dir/.netrc; do

if [ ! -h "$file" -a -f "$file" ]; then
fileperm=`/bin/ls -ld $file | /bin/cut -f1 -d" "`

if [ `echo $fileperm | /bin/cut -c5 ` != "-" ]
then
printf "\033[33;32m Group Read set on $file . \n"
else
printf "\033[33;31m Group Read not set on $file . \n"
fi

if [ `echo $fileperm | /bin/cut -c6 ` != "-" ]
then
printf "\033[33;32m Group Write set on $file . \n"
else
printf "\033[33;31m Group Write not set on $file . \n"
fi

if [ `echo $fileperm | /bin/cut -c7 ` != "-" ]
then
printf "\033[33;32m Group Execute set on $file . \n"
else
printf "\033[33;31m Group Execute not set on $file . \n"
fi

if [ `echo $fileperm | /bin/cut -c8 ` != "-" ]
then
printf "\033[33;32m Other Read set on $file . \n"
else
printf "\033[33;31m Other Read not set on $file . \n"
fi

if [ `echo $fileperm | /bin/cut -c9 ` != "-" ]
then
printf "\033[33;32m Other Write set on $file . \n"
else
printf "\033[33;31m Other Write not set on $file . \n"
fi

if [ `echo $fileperm | /bin/cut -c10 ` != "-" ]
then
printf "\033[33;32m Other Execute set on $file . \n"
else
printf "\033[33;31m Other Execute not set on $file . \n"
fi
fi
echo  -en "\e[0m"
done
done
