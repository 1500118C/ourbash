#! /bin/bash
clear 

echo "7.4 Disable User Accounts"

RESULT=$(egrep -v "^\+" /etc/passwd | awk -F: '($1!="root" && $1!="sync" && $1!="shutdown" && $1!="halt" && $3<1000 && $7!="/usr/sbin/nologin" && $7!="/sbin/nologin" && $7!="/bin/false")')

if [ -z $RESULT ]; then
 printf "\e[32mSuccessful\e[0m\n"

else
 
printf "\e[31mYour account should be locked! Please do remediation!\e[0m\n"
egrep -v "^\+" /etc/passwd | awk -F: '($1!="root" && $1!="sync" && $1!="shutdown" && $1!="halt" && $3<1000 && $7!="/usr/sbin/nologin" && $7!="/sbin/nologin")' |  cut -d : -f 1 

fi
